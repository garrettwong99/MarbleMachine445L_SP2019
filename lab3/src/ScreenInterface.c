/* ScreenInterface.c
 * Authors: Takuma Fujiwara and Rish Bhatnagar
 * Initial Creation Date: 2/11/2020
 * Description: Contains functions for drawing alarm clock on LCD.
 * Lab 3
 * TA: Bhagawat Vinay
 * Last Revision: 2/21/2020
 * 
 */

// hardware connections
// **********ST7735 TFT and SDC*******************
// ST7735
// Backlight (pin 10) connected to +3.3 V
// MISO (pin 9) unconnected
// SCK (pin 8) connected to PA2 (SSI0Clk)
// MOSI (pin 7) connected to PA5 (SSI0Tx)
// TFT_CS (pin 6) connected to PA3 (SSI0Fss)
// CARD_CS (pin 5) unconnected
// Data/Command (pin 4) connected to PA6 (GPIO), high for data, low for command
// RESET (pin 3) connected to PA7 (GPIO)
// VCC (pin 2) connected to +3.3 V
// Gnd (pin 1) connected to ground

#include "../inc/ScreenInterface.h"
#include "../../inc/ST7735.h"

const unsigned short one[] = {
 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000,
 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000,
 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000,
 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000,

};

const unsigned short two[] = {
 0x0000, 0x0000, 0x0000, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000,
 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000,
 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF, 0xFFFF, 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF,
 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x0000,

};

const unsigned short three[] = {
 0x0000, 0x0000, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000,
 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000,
 0x0000, 0x0000, 0x0000, 0xFFFF, 0xFFFF, 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000,
 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x0000, 0x0000,


};

const unsigned short four[] = {
 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000,
 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x0000, 0x0000,
 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000,
 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000,

};

const unsigned short five[] = {
 0x0000, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000,
 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000,
 0x0000, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x0000,

};

const unsigned short six[] = {
 0x0000, 0x0000, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000,
 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000,
 0x0000, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x0000, 0x0000,

};

const unsigned short seven[] = {
 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000,
 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000,
 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x0000,

};

const unsigned short eight[] = {
 0x0000, 0x0000, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000,
 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000,
 0x0000, 0x0000, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000,
 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x0000, 0x0000,

};

const unsigned short nine[] = {
 0x0000, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000,
 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x0000,
 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000,
 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x0000, 0x0000,


};

const unsigned short ten[] = {
 0xFFFF, 0x0000, 0x0000, 0x0000, 0xFFFF, 0xFFFF, 0xFFFF, 0x0000, 0xFFFF, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0xFFFF,
 0xFFFF, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0xFFFF, 0xFFFF, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0xFFFF,
 0xFFFF, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0xFFFF, 0xFFFF, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0xFFFF,
 0xFFFF, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0xFFFF, 0xFFFF, 0x0000, 0x0000, 0x0000, 0xFFFF, 0xFFFF, 0xFFFF, 0x0000,

};

const unsigned short eleven[] = {
 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000,
 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000,
 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000,
 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000,

};

const unsigned short twelve[] = {
 0xFFFF, 0x0000, 0x0000, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000,
 0xFFFF, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000,
 0xFFFF, 0x0000, 0x0000, 0x0000, 0xFFFF, 0xFFFF, 0xFFFF, 0x0000, 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF,
 0xFFFF, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF, 0xFFFF, 0x0000, 0x0000, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x0000,


};

const uint8_t center_X = 63;
const uint8_t center_Y = 88;
const uint8_t hour_X[12] = {63,72,80,83,80,73,63,53,45,43,47,53};
const uint8_t hour_Y[12] = {70,72,80,88,98,105,108,104,98,88,80,72};

const uint8_t minute_X[60] = {
  63,66,69,72,74,77,80,82,84,86,
  88,90,92,93,94,95,95,95,95,94,
  93,92,90,88,84,80,76,73,70,66,
  63,60,56,53,50,47,45,43,40,38,
  36,35,34,33,32,32,32,32,33,35,
  37,38,40,42,45,48,51,54,57,60
};

const uint8_t minute_Y[60] = {
  58,58,59,60,61,63,64,66,68,70,
  73,76,79,82,85,88,91,94,98,102,
  105,107,110,112,115,116,118,119,120,121,
  121,121,120,119,117,115,113,111,109,106,
  102,99,97,94,90,88,86,83,80,77,
  74,70,67,65,63,61,59,58,57,57
};

const uint8_t circle_X[200] = {
  64,65,67,68,69,70,72,73,74,75,76,77,78,80,81,82,83,84,85,
  86,87,88,89,90,91,91,92,93,94,95,95,96,97,97,98,98,99,99,
  100,100,100,101,101,101,102,102,102,102,102,102,102,102,
  102,102,102,101,101,101,100,100,100,99,99,98,98,97,97,96,
  95,95,94,93,92,91,91,90,89,88,87,86,85,84,83,82,81,80,78,
  77,76,75,74,73,72,70,69,68,67,65,64,63,62,61,59,58,57,56,
  54,53,52,51,50,49,48,46,45,44,43,42,41,40,39,38,37,36,35,
  35,34,33,32,31,31,30,29,29,28,28,27,27,26,26,26,25,25,25,
  24,24,24,24,24,24,24,24,24,24,24,25,25,25,26,26,26,27,27,
  28,28,29,29,30,31,31,32,33,34,35,35,36,37,38,39,40,41,42,
  43,44,45,46,48,49,50,51,52,53,54,56,57,58,59,61,62,63};

const uint8_t circle_Y[200] = {
  129,129,129,129,129,128,128,128,127,127,127,126,126,125,
  125,124,124,123,122,122,121,120,119,118,118,117,116,115,
  114,113,112,111,110,109,108,107,105,104,103,102,101,100,
  99,97,96,95,94,92,91,90,89,88,86,85,84,83,81,80,79,78,77,
  76,75,73,72,71,70,69,68,67,66,65,64,63,62,62,61,60,59,58,
  58,57,56,56,55,55,54,54,53,53,53,52,52,52,51,51,51,51,51,
  51,51,51,51,51,51,52,52,52,53,53,53,54,54,55,55,56,56,57,
  58,58,59,60,61,62,62,63,64,65,66,67,68,69,70,71,72,73,75,
  76,77,78,79,80,81,83,84,85,86,88,89,90,91,92,94,95,96,97,
  99,100,101,102,103,104,105,107,108,109,110,111,112,113,114,
  115,116,117,118,118,119,120,121,122,122,123,124,124,125,
  125,126,126,127,127,127,128,128,128,129,129,129,129,129,129};

//------------Screen_Init------------
// Initializes LCD and draws a clock with given initial time.
// Input: initialHour - integer from 0 to 23.
//        initialMinute - integer from 0 to 59.
// Output: none
void Screen_Init(uint8_t initialHour, uint8_t initialMinute){
  ST7735_InitR(INITR_REDTAB);
  ST7735_SetCursor(0,0);
  ST7735_OutString("Lab 3");
  ST7735_SetCursor(0,1);
  ST7735_OutString("Time:");
  ST7735_SetCursor(0,2);
  ST7735_OutString("Alarm:");
  Draw_Clockface();
  Draw_Hands(initialHour, initialMinute);
}

//------------Draw_Hands------------
// Draws hour and minute hands onto clock face.
// Input: hour - integer from 0 to 23.
//        minute - integer from 0 to 59.
// Output: none
void Draw_Hands(uint8_t hour, uint8_t minute){
  int8_t previousHour;
  int8_t previousMinute = minute-1;
  
  if(hour>=12){
    hour=hour-12;
  }
  previousHour = hour-1;
  if(previousHour==-1){
    previousHour=11;
  }

  
  if(previousMinute==-1){
    previousMinute=59;
  }
  
  ST7735_Line(center_X,center_Y,minute_X[previousMinute],minute_Y[previousMinute],ST7735_BLACK);
  ST7735_Line(center_X,center_Y,hour_X[previousHour],hour_Y[previousHour],ST7735_BLACK);
  ST7735_Line(center_X,center_Y,minute_X[minute],minute_Y[minute],ST7735_YELLOW);
  ST7735_Line(center_X,center_Y,hour_X[hour],hour_Y[hour],ST7735_RED);
}


//------------Draw_Circle------------
// Function used by Draw_Clockface() to draw a circle.
// Input: none
// Output: none
void Draw_Circle(void){
  for(int i = 0; i<200; i++){
    ST7735_DrawPixel(circle_X[i],circle_Y[i],ST7735_WHITE);
  }
}

//------------Show_AlarmTime------------
// Displays alarm time in digital format.
// Input: hour - integer from 0 to 23.
//        minute - integer from 0 to 59.
//        second - integer from 0 to 59.
// Output: none
void Show_AlarmTime(uint8_t hour, uint8_t minute, uint8_t second){
  ST7735_SetCursor(6,2);
  if(hour<10){
    ST7735_OutUDec(0);
  }
  ST7735_OutUDec(hour);
  ST7735_OutChar(':');
  if(minute<10){
    ST7735_OutUDec(0);
  }
  ST7735_OutUDec(minute);
  ST7735_OutChar(':');
  if(second<10){
    ST7735_OutUDec(0);
  }
  ST7735_OutUDec(second);
}

//------------Show_DigitalTime------------
// Displays current time in digital format.
// Input: hour - integer from 0 to 23.
//        minute - integer from 0 to 59.
//        second - integer from 0 to 59.
// Output: none
void Show_DigitalTime(uint8_t hour, uint8_t minute, uint8_t second){
  ST7735_SetCursor(5,1);
  if(hour<10){
    ST7735_OutUDec(0);
  }
  ST7735_OutUDec(hour);
  ST7735_OutChar(':');
  if(minute<10){
    ST7735_OutUDec(0);
  }
  ST7735_OutUDec(minute);
  ST7735_OutChar(':');
  if(second<10){
    ST7735_OutUDec(0);
  }
  ST7735_OutUDec(second);
  Draw_Hands(hour, minute);
}

//------------Draw_Clockface------------
// Draws a circle with the numbers 1 through 12 placed evenly around circle.
// Input: none
// Output: none
void Draw_Clockface(void){
  Draw_Circle();
  ST7735_DrawBitmap(60,47,twelve,8,8);
  ST7735_DrawBitmap(80,52,one,8,8);
  ST7735_DrawBitmap(98,70,two,8,8);
  ST7735_DrawBitmap(104,94,three,8,8);
  ST7735_DrawBitmap(98,118,four,8,8);
  ST7735_DrawBitmap(80,136,five,8,8);
  ST7735_DrawBitmap(60,141,six,8,8);
  ST7735_DrawBitmap(40,136,seven,8,8);
  ST7735_DrawBitmap(22,118,eight,8,8);
  ST7735_DrawBitmap(16,94,nine,8,8);
  ST7735_DrawBitmap(22,70,ten,8,8);
  ST7735_DrawBitmap(40,52,eleven,8,8);
}
